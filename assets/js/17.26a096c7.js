(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{361:function(e,t,a){"use strict";a.r(t);var s=a(43),v=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"ajv-cli"}},[e._v("Ajv-cli "),a("Badge",{attrs:{text:"v 3.2.1"}})],1),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/ajv-validator/ajv-cli#compile-schemas",target:"_blank",rel:"noopener noreferrer"}},[e._v("英文原地址"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("ajv 的命令行接口，最快的 JSON schema 验证器之一。支持 JSON、JSON5 和 YAML。")]),e._v(" "),a("h2",{attrs:{id:"安装"}},[e._v("安装")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g ajv-cli\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"help"}},[e._v("Help")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("help")]),e._v("\najv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("help")]),e._v(" validate\najv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("help")]),e._v(" compile\najv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("help")]),e._v(" migrate\najv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("help")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("h2",{attrs:{id:"验证数据"}},[e._v("验证数据")]),e._v(" "),a("p",[e._v("该命令根据 JSON-schema 验证数据文件。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv validate -s test/schema.json -d test/valid_data.json\najv -s test/schema.json -d test/valid_data.json\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("您可以从"),a("a",{attrs:{href:"https://nodejs.org/api/modules.html#modules_file_modules",target:"_blank",rel:"noopener noreferrer"}},[e._v("输入文件名"),a("OutboundLink")],1),e._v("中省略"),a("code",[e._v("validate")]),e._v("命令名和"),a("code",[e._v(".json")]),e._v("。")]),e._v(" "),a("h3",{attrs:{id:"参数"}},[e._v("参数")]),e._v(" "),a("h4",{attrs:{id:"s-json-schema-的文件名"}},[a("code",[e._v("-s")]),e._v(" JSON schema 的文件名")]),e._v(" "),a("p",[e._v("该参数只能传递一个 schema。")]),e._v(" "),a("h4",{attrs:{id:"d-json-数据"}},[a("code",[e._v("-d")]),e._v(" JSON 数据")]),e._v(" "),a("p",[e._v("可传入多个数据文件，类似"),a("code",[e._v("-r")]),e._v("参数。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv -s test/schema.json -d "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"test/valid*.json"')]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("如果某些文件是无效文件，退出代码为"),a("code",[e._v("1")]),e._v("。")]),e._v(" "),a("h4",{attrs:{id:"r-引用-schema"}},[a("code",[e._v("-r")]),e._v(" 引用 schema")]),e._v(" "),a("p",[a("code",[e._v("-s")]),e._v(" 参数中的 schema 可以使用"),a("code",[e._v("$ref")]),e._v("关键字来引用这些 schema 中的任意一个。")]),e._v(" "),a("p",[e._v("通过多次使用该参数和使用"),a("a",{attrs:{href:"https://github.com/isaacs/node-glob#glob-primer",target:"_blank",rel:"noopener noreferrer"}},[e._v("通配符"),a("OutboundLink")],1),e._v("，可以传递多个 schema。通配符应该用引号包裹且扩展名不能省略。")]),e._v(" "),a("h3",{attrs:{id:"m-元-schema"}},[a("code",[e._v("-m")]),e._v(" 元 schema")]),e._v(" "),a("p",[e._v("schema 可以使用这些 schema 中的任意一个作为元 schema (即在 $schema 关键字中使用的 schema —— 它用于验证 schema 本身)。")]),e._v(" "),a("p",[e._v("可以传入多个元 schema，类似"),a("code",[e._v("-r")]),e._v("参数。")]),e._v(" "),a("h3",{attrs:{id:"c-自定义关键字-格式定义"}},[a("code",[e._v("-c")]),e._v(" 自定义关键字/格式定义")]),e._v(" "),a("p",[e._v("您可以传入自定义的关键字/格式的模块。该模块应该导出一个接受 Ajv 实例作为参数的函数。文件名应该以 “.” 开头，它会相对于当前文件夹解析路径。也可以传入包名————它会在"),a("code",[e._v("require")]),e._v("中原封不动地使用。")]),e._v(" "),a("p",[e._v("举例来说，您可以使用"),a("code",[e._v("-c ajv-keywords")]),e._v("添加来自"),a("a",{attrs:{href:"https://github.com/epoberezkin/ajv-keywords",target:"_blank",rel:"noopener noreferrer"}},[e._v("ajv-keywords"),a("OutboundLink")],1),e._v("包的所有关键字，或者使用"),a("code",[e._v("-c ajv-keywords/keywords/typeof")]),e._v("仅添加类型的关键字。")]),e._v(" "),a("h3",{attrs:{id:"配置项"}},[e._v("配置项")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("--errors=")]),e._v("：错误报告格式。可能的值：")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("js")]),e._v("（默认值）：JavaScript 对象。")]),e._v(" "),a("li",[a("code",[e._v("json")]),e._v("：带缩进和换行的 JSON。")]),e._v(" "),a("li",[a("code",[e._v("line")]),e._v("：不带缩进/换行的JSON（为了便于解析）。")]),e._v(" "),a("li",[a("code",[e._v("text")]),e._v("：带有数据路径的错误消息。")])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("--changes=")]),e._v("：在验证后侦测数据中的改变。")])])]),e._v(" "),a("p",[e._v("可以使用"),a("a",{attrs:{href:"https://github.com/ajv-validator/ajv-cli#ajv-options",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ajv 配置项"),a("OutboundLink")],1),a("code",[e._v("——remove-additional")]),e._v("、"),a("code",[e._v("——use-defaults")]),e._v("和"),a("code",[e._v("——coerce-types")]),e._v("来修改数据。")]),e._v(" "),a("p",[e._v("这些更改以"),a("code",[e._v("JSON-patch")]),e._v("格式("),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6902",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC6902"),a("OutboundLink")],1),e._v(")报告。")]),e._v(" "),a("p",[e._v("可能的值是"),a("code",[e._v("js(默认)")]),e._v("、"),a("code",[e._v("json")]),e._v("和"),a("code",[e._v("line")]),e._v("(参见"),a("code",[e._v("--errors")]),e._v("选项)。")]),e._v(" "),a("h2",{attrs:{id:"编译-schema"}},[e._v("编译 schema")]),e._v(" "),a("p",[e._v("该命令在不验证任何数据的情况下验证和编译模式。")]),e._v(" "),a("p",[e._v("它可用于检查 schema 是否有效，并创建导出验证函数的独立模块(使用"),a("a",{attrs:{href:"https://github.com/epoberezkin/ajv-pack",target:"_blank",rel:"noopener noreferrer"}},[e._v("ajv-pack"),a("OutboundLink")],1),e._v(")。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv compile -s schema\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 编译到模块 (BETA)")]),e._v("\najv compile -s schema -o validate.js\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h3",{attrs:{id:"参数-2"}},[e._v("参数")]),e._v(" "),a("h4",{attrs:{id:"s-json-schema-的文件名-2"}},[a("code",[e._v("-s")]),e._v(" JSON schema 的文件名")]),e._v(" "),a("p",[e._v("通过多次使用该参数和使用"),a("a",{attrs:{href:"https://github.com/isaacs/node-glob#glob-primer",target:"_blank",rel:"noopener noreferrer"}},[e._v("通配符"),a("OutboundLink")],1),e._v("，可以传递多个 schema。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv compile -s "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"test/schema*.json"')]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h4",{attrs:{id:"o-已编译验证功能模块的输出文件-beta"}},[a("code",[e._v("-o")]),e._v(" 已编译验证功能模块的输出文件 (BETA)")]),e._v(" "),a("p",[e._v("只有单个 schema 可以使用该配置项进行编译。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv compile -s "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"schema.json"')]),e._v(" -o "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"validate_schema.js"')]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("改命令也支持"),a("code",[e._v("-r")]),e._v("、"),a("code",[e._v("-m")]),e._v("和"),a("code",[e._v("-c")]),e._v("参数。")]),e._v(" "),a("h2",{attrs:{id:"将-schema-迁移到-draft-06"}},[e._v("将 schema 迁移到 draft-06")]),e._v(" "),a("p",[e._v("该命令使用"),a("a",{attrs:{href:"https://github.com/epoberezkin/json-schema-migrate",target:"_blank",rel:"noopener noreferrer"}},[e._v("json-schema-migrate"),a("OutboundLink")],1),e._v("包验证模式并将其迁移到 draft-06。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv migrate -s schema\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 编译到指定文件名")]),e._v("\najv migrate -s schema -o migrated_schema.json\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h3",{attrs:{id:"参数-3"}},[e._v("参数")]),e._v(" "),a("h4",{attrs:{id:"s-json-schema-的文件名-3"}},[a("code",[e._v("-s")]),e._v(" JSON schema 的文件名")]),e._v(" "),a("p",[e._v("通过多次使用该参数和使用"),a("a",{attrs:{href:"https://github.com/isaacs/node-glob#glob-primer",target:"_blank",rel:"noopener noreferrer"}},[e._v("通配符"),a("OutboundLink")],1),e._v("，可以传递多个 schema。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv migrate -s "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"test/schema*.json"')]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("如果没有指定参数"),a("code",[e._v("-o")]),e._v("，则迁移的 schema 会被写入相同的文件，原始文件使用"),a("code",[e._v(".bak")]),e._v("扩展名保留下来。")]),e._v(" "),a("h4",{attrs:{id:"o-迁移-schema-的输出文件"}},[a("code",[e._v("-o")]),e._v(" 迁移 schema 的输出文件")]),e._v(" "),a("p",[e._v("只有单个 schema 可以使用该配置项进行编译。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv compile -s "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"schema.json"')]),e._v(" -o migrated_schema.json\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h4",{attrs:{id:"配置项-2"}},[a("strong",[e._v("配置项")])]),e._v(" "),a("ul",[a("li",[a("code",[e._v("v5")]),e._v("：如果未指定 $schema，则将 schema 迁移为 v5")]),e._v(" "),a("li",[a("code",[e._v("--indent=")]),e._v("：迁移模式 JSON 文件中的缩进，默认为 4")]),e._v(" "),a("li",[a("code",[e._v("--validate-schema=false")]),e._v("：跳过 schema 验证")])]),e._v(" "),a("h2",{attrs:{id:"测试验证结果"}},[e._v("测试验证结果")]),e._v(" "),a("p",[e._v("该命令断言验证的结果与预期一致。")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ajv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v(" -s test/schema.json -d test/valid_data.json --valid\najv "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v(" -s test/schema.json -d test/invalid_data.json --invalid\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("如果配置项"),a("code",[e._v("--valid")]),e._v("("),a("code",[e._v("--invalid")]),e._v(")用于"),a("code",[e._v("test")]),e._v("通过(退出代码 0)，那么数据文件应该是有效(无效)的。")]),e._v(" "),a("p",[e._v("此命令支持与"),a("code",[e._v("validate")]),e._v("相同的配置项和参数，但"),a("code",[e._v("--changes")]),e._v("除外")]),e._v(" "),a("h2",{attrs:{id:"ajv-配置项"}},[e._v("Ajv 配置项")]),e._v(" "),a("p",[e._v("您可以传入以下Ajv 配置项("),a("code",[e._v("migrate")]),e._v("命令除外):")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[e._v("配置项")]),e._v(" "),a("th",[e._v("描述")])])]),e._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--data")])]),e._v(" "),a("td",[e._v("使用"),a("a",{attrs:{href:"https://github.com/epoberezkin/ajv#data-reference",target:"_blank",rel:"noopener noreferrer"}},[e._v("$data 引用"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--all-errors")])]),e._v(" "),a("td",[e._v("收集所有错误")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--unknown-formats=")])]),e._v(" "),a("td",[e._v("处理未知格式")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--verbose")])]),e._v(" "),a("td",[e._v("在错误中包含 schema 和数据")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--json-pointers")])]),e._v(" "),a("td",[e._v("使用 json 指针报告错误中的数据路径")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--unique-items=false")])]),e._v(" "),a("td",[e._v("不验证"),a("code",[e._v("uniqueItems")]),e._v("关键字")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--unicode=false")])]),e._v(" "),a("td",[e._v("将 unicode 对计数为 2 个字符")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--format=full")])]),e._v(" "),a("td",[e._v("格式模式")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--schema-id=")])]),e._v(" "),a("td",[e._v("关键字作为 schema ID使用")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--extend-refs=")])]),e._v(" "),a("td",[e._v("当 schema 中存在$ref时，验证其他关键字")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--missing-refs=")])]),e._v(" "),a("td",[e._v("处理缺失的引用 schema ("),a("code",[e._v("true")]),e._v("/"),a("code",[e._v("ignore")]),e._v("/"),a("code",[e._v("fail")]),e._v(")")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--inline-refs=")])]),e._v(" "),a("td",[e._v("引用 schema 编译模式("),a("code",[e._v("true")]),e._v("/"),a("code",[e._v("false")]),e._v("/"),a("code",[e._v("<number>")]),e._v(")")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--remove-additional")])]),e._v(" "),a("td",[e._v("移除额外属性 ("),a("code",[e._v("true")]),e._v("/"),a("code",[e._v("all")]),e._v("/"),a("code",[e._v("failing")]),e._v(")")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--use-defaults")])]),e._v(" "),a("td",[e._v("用默认关键字中的值替换缺少的属性/项")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--coerce-types")])]),e._v(" "),a("td",[e._v("更改数据类型以匹配类型关键字")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--multiple-of-precision")])]),e._v(" "),a("td",[a("code",[e._v("multipleOf")]),e._v("的精度，传入整数")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--error-data-path=property")])]),e._v(" "),a("td",[e._v("错误的数据路径")])]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("code",[e._v("--messages=false")])]),e._v(" "),a("td",[e._v("不包括错误中文本信息")])])])]),e._v(" "),a("p",[e._v("配置项可以以中横线格式或驼峰格式进行传递。")])])}),[],!1,null,null,null);t.default=v.exports}}]);